{"version":3,"file":"AdminAddMenuService.js","sourceRoot":"./src/","sources":["Service/Admin/AdminAddMenuService.ts"],"names":[],"mappings":";;;AAGA,wDAAqD;AAErD,MAAa,mBAAmB;IAM5B,gBAAgB,CAAC;IAEjB,MAAM,CAAC,OAAgB,EAAE,OAAgB,EAAE,IAAgB;QACvD,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAED,SAAS;QAOL,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;YAE1C,IAAI,SAAS,GAAa,EAAE,CAAC;YAE7B,IAAI,OAAO,GAAY,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC;YACrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;gBAChD,IAAI,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;gBAClC,IAAI,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;gBAC1D,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;aACnC;YAED,IAAI,IAAI,GAAc,IAAI,qBAAS,EAAE,CAAC;YACtC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC;YAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAE3B,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QAErC,CAAC,CAAC,CAAC;IAEP,CAAC;CAEJ;AA3CD,kDA2CC","sourcesContent":["import { HttpServer } from \"jackwebutil\";\r\nimport { FoodDao } from \"../../DB/Dao/Food/FoodDao\";\r\nimport { MenuDao } from \"../../DB/Dao/Menu/MenuDao\";\r\nimport { MenuTable } from \"../../DB/Table/MenuTable\";\r\n\r\nexport class AdminAddMenuService {\r\n\r\n    menuDao: MenuDao;\r\n    foodDao: FoodDao;\r\n    http: HttpServer;\r\n\r\n    constructor() { }\r\n\r\n    Inject(menuDao: MenuDao, foodDao: FoodDao, http: HttpServer): void {\r\n        this.menuDao = menuDao;\r\n        this.foodDao = foodDao;\r\n        this.http = http;\r\n    }\r\n\r\n    Listening() {\r\n\r\n        type NewMenu = {\r\n            date: string,\r\n            foodArr: string[]\r\n        }\r\n\r\n        this.http.PostListen(\"/AddMenu\", (req, res) => {\r\n\r\n            let foodIdArr: number[] = [];\r\n\r\n            let newMenu: NewMenu = req.body.data;\r\n            for (let i = 0; i < newMenu.foodArr.length; i += 1) {\r\n                let foodName = newMenu.foodArr[i];\r\n                let insertedFood = this.foodDao.AddFoodWithName(foodName);\r\n                foodIdArr.push(insertedFood.id);\r\n            }\r\n\r\n            let menu: MenuTable = new MenuTable();\r\n            menu.yyyymmdd = newMenu.date;\r\n            menu.foodIdArr = foodIdArr;\r\n            this.menuDao.AddMenu(menu);\r\n\r\n            console.log(\"收到录入菜单: \", newMenu);\r\n\r\n        });\r\n\r\n    }\r\n\r\n}"]}