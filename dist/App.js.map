{"version":3,"file":"App.js","sourceRoot":"./src/","sources":["App.ts"],"names":[],"mappings":";;AAAA,6CAAyC;AACzC,mDAAgD;AAChD,mDAAgD;AAChD,uEAAoE;AACpE,+DAA4D;AAC5D,oFAAiF;AACjF,oEAAiE;AACjE,kDAA+C;AAC/C,6EAA0E;AAC1E,kDAA+C;AAC/C,4DAAyD;AACzD,kFAA+E;AAC/E,4DAAyD;AACzD,gGAA6F;AAC7F,yFAAsF;AACtF,oCAAiC;AAEjC,MAAM,IAAI,GAAG,IAAI,CAAC;AAElB,MAAM,GAAG;IAEL,MAAM,CAAC,IAAI;QAEP,QAAQ;QACR,uBAAU,CAAC,IAAI,EAAE,CAAC;QAElB,UAAU;QACV,IAAI,OAAO,GAAkB,yBAAW,CAAC,gBAAgB,CAAgB,uBAAU,CAAC,mBAAmB,EAAE,CAAC,CAAC;QAC3G,IAAI,CAAC,OAAO,EAAE;YACV,OAAO,GAAG,IAAI,6BAAa,EAAE,CAAC;YAC9B,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;YACnB,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;YACnB,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;YACtB,yBAAW,CAAC,WAAW,CAAC,uBAAU,CAAC,mBAAmB,EAAE,EAAE,OAAO,CAAC,CAAC;YACnE,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SAC5B;aAAM;YACH,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SAC5B;QACD,iBAAO,CAAC,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC;QACnC,iBAAO,CAAC,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC;QACnC,uBAAU,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;QACzC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAEtB,iBAAiB;QACjB,YAAY;QACZ,IAAI,IAAI,GAAe,IAAI,wBAAU,EAAE,CAAC;QAExC,WAAW;QACX,IAAI,OAAO,GAAY,IAAI,iBAAO,EAAE,CAAC;QACrC,IAAI,OAAO,GAAY,IAAI,iBAAO,EAAE,CAAC;QACrC,IAAI,UAAU,GAAe,IAAI,uBAAU,EAAE,CAAC;QAE9C,WAAW;QACX,IAAI,WAAW,GAAgB,IAAI,yBAAW,EAAE,CAAC;QAEjD,oBAAoB;QACpB,IAAI,WAAW,GAAgB,IAAI,yBAAW,EAAE,CAAC;QACjD,IAAI,mBAAmB,GAAwB,IAAI,yCAAmB,EAAE,CAAC;QACzE,IAAI,kBAAkB,GAAuB,IAAI,uCAAkB,EAAE,CAAC;QACtE,IAAI,yBAAyB,GAA+B,IAAI,qDAAyB,EAAE,CAAC;QAE5F,qBAAqB;QACrB,IAAI,YAAY,GAAiB,IAAI,2BAAY,EAAE,CAAC;QACpD,IAAI,mBAAmB,GAAwB,IAAI,yCAAmB,EAAE,CAAC;QACzE,IAAI,yBAAyB,GAA8B,IAAI,qDAAyB,EAAE,CAAC;QAE3F,mBAAmB;QACnB,sBAAsB;QACtB,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACzB,mBAAmB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC;QAChE,kBAAkB,CAAC,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;QAC5C,yBAAyB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAE1C,uBAAuB;QACvB,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC1B,mBAAmB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;QACnD,yBAAyB,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;QAE5D,WAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;QAE1C,iBAAiB;QACjB,YAAY;QACZ,MAAM,QAAQ,GAAW,QAAQ,CAAC;QAClC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,uBAAU,CAAC,UAAU,EAAE,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAErE,WAAW;QACX,OAAO,CAAC,IAAI,EAAE,CAAC;QACf,OAAO,CAAC,IAAI,EAAE,CAAC;QACf,UAAU,CAAC,IAAI,EAAE,CAAC;QAElB,oBAAoB;QACpB,WAAW,CAAC,IAAI,EAAE,CAAC;QACnB,mBAAmB,CAAC,IAAI,EAAE,CAAC;QAC3B,kBAAkB,CAAC,IAAI,EAAE,CAAC;QAC1B,yBAAyB,CAAC,IAAI,EAAE,CAAC;QAEjC,qBAAqB;QACrB,YAAY,CAAC,SAAS,EAAE,CAAC;QACzB,mBAAmB,CAAC,SAAS,EAAE,CAAC;QAChC,yBAAyB,CAAC,SAAS,EAAE,CAAC;QAEtC,gBAAgB;QAChB,IAAI,CAAC,KAAK,EAAE,CAAC;QAEb,WAAW,CAAC,GAAG,EAAE;YACb,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;QAC/B,CAAC,EAAE,IAAI,CAAE,CAAC;IAEd,CAAC;CAEJ;AAED,GAAG,CAAC,IAAI,EAAE,CAAC","sourcesContent":["import { HttpServer } from \"jackwebutil\";\r\nimport { FoodDao } from \"./DB/Dao/Food/FoodDao\";\r\nimport { MenuDao } from \"./DB/Dao/Menu/MenuDao\";\r\nimport { HomeMenuCao } from \"./Service/Home/Repository/HomeMenuCao\";\r\nimport { AdminService } from \"./Service/Admin/AdminService\";\r\nimport { HomeLoadMenuService } from \"./Service/Home/Service/HomeLoadMenuService\";\r\nimport { HomeService } from \"./Service/Home/Service/HomeService\";\r\nimport { PathHelper } from \"./Util/PathHelper\";\r\nimport { AdminAddMenuService } from \"./Service/Admin/AdminAddMenuService\";\r\nimport { JsonVisitor } from \"./DB/JsonVisitor\";\r\nimport { IdRecordTable } from \"./DB/Table/IdRecordTable\";\r\nimport { HomeCommentService } from \"./Service/Home/Service/HomeCommentService\";\r\nimport { CommentDao } from \"./DB/Dao/Comment/CommentDao\";\r\nimport { HomeResetTodayMenuService } from \"./Service/Home/Service/HomeResetTodayMenuService\";\r\nimport { AdminGetAllCommentService } from \"./Service/Admin/AdminGetAllCommentService\";\r\nimport { Daos } from \"./DB/Daos\";\r\n\r\nconst PORT = 9966;\r\n\r\nclass App {\r\n\r\n    static main() {\r\n\r\n        // 初始化路径\r\n        PathHelper.Init();\r\n\r\n        // 初始化表 ID\r\n        let idTable: IdRecordTable = JsonVisitor.ReadJsonFromFile<IdRecordTable>(PathHelper.GetIdRecordFilePath());\r\n        if (!idTable) {\r\n            idTable = new IdRecordTable();\r\n            idTable.foodId = 0;\r\n            idTable.menuId = 0;\r\n            idTable.commentId = 0;\r\n            JsonVisitor.WriteToFile(PathHelper.GetIdRecordFilePath(), idTable);\r\n            console.log(\"创建表ID记录文件\");\r\n        } else {\r\n            console.log(\"读取表ID记录文件\");\r\n        }\r\n        FoodDao.currentId = idTable.foodId;\r\n        MenuDao.currentId = idTable.menuId;\r\n        CommentDao.currentId = idTable.commentId;\r\n        console.log(\"初始化表ID\");\r\n\r\n        // ==== CTOR ====\r\n        // CTOR HTTP\r\n        let http: HttpServer = new HttpServer();\r\n\r\n        // CTOR DAO\r\n        let menuDao: MenuDao = new MenuDao();\r\n        let foodDao: FoodDao = new FoodDao();\r\n        let commentDao: CommentDao = new CommentDao();\r\n\r\n        // CTOR CAO\r\n        let homeMenuCao: HomeMenuCao = new HomeMenuCao();\r\n\r\n        // CTOR HOME SERVICE\r\n        let homeService: HomeService = new HomeService();\r\n        let homeLoadMenuService: HomeLoadMenuService = new HomeLoadMenuService();\r\n        let homeCommentService: HomeCommentService = new HomeCommentService();\r\n        let homeResetTodayMenuService : HomeResetTodayMenuService = new HomeResetTodayMenuService();\r\n\r\n        // CTOR ADMIN SERVICE\r\n        let adminService: AdminService = new AdminService();\r\n        let adminAddMenuService: AdminAddMenuService = new AdminAddMenuService();\r\n        let adminGetAllCommentService: AdminGetAllCommentService = new AdminGetAllCommentService();\r\n\r\n        // ==== INJECT ====\r\n        // INJECT HOME SERVICE\r\n        homeService.Inject(http);\r\n        homeLoadMenuService.Inject(foodDao, menuDao, homeMenuCao, http);\r\n        homeCommentService.Inject(http, commentDao);\r\n        homeResetTodayMenuService.Inject(menuDao);\r\n\r\n        // INJECT ADMIN SERVICE\r\n        adminService.Inject(http);\r\n        adminAddMenuService.Inject(menuDao, foodDao, http);\r\n        adminGetAllCommentService.Inject(http, foodDao, commentDao);\r\n\r\n        Daos.Inject(menuDao, foodDao, commentDao);\r\n\r\n        // ==== INIT ====\r\n        // INIT HTTP\r\n        const viewPath: string = \"/view/\";\r\n        http.InitHttpView(PORT, PathHelper.GetRootDir(), viewPath, viewPath);\r\n\r\n        // INIT DAO\r\n        menuDao.Init();\r\n        foodDao.Init();\r\n        commentDao.Init();\r\n\r\n        // INIT HOME SERVICE\r\n        homeService.Init();\r\n        homeLoadMenuService.Init();\r\n        homeCommentService.Init();\r\n        homeResetTodayMenuService.Init();\r\n\r\n        // INIT ADMIN SERVICE\r\n        adminService.Listening();\r\n        adminAddMenuService.Listening();\r\n        adminGetAllCommentService.Listening();\r\n\r\n        // ==== RUN ====\r\n        http.Start();\r\n\r\n        setInterval(() => {\r\n            let date = new Date();\r\n            console.log(date.getDay());\r\n        }, 1000 );\r\n\r\n    }\r\n\r\n}\r\n\r\nApp.main();"]}